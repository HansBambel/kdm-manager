        <tr class="ul route_root">
            <th colspan="3">
                <a id="survivorDataModel"></a>
                <p> <b>Survivor Routes:</b> all routes for working directly with
                an individual survivor follow a <code>
                /settlement/&lt;action&gt;/&lt;settlement_id&gt;</code> convention.</p>

                <p>Like settlement management routes, these routes are private, require
                authentication and accept the <code>OPTIONS</code> requests method.</p>

                <p><b>Important!</b> Any <b>POST</b> to any of these routes can also
                include the optional parameter <code>{"serialize_on_response": true}
                </code>. Including this param will get you a serialized version
                of the survivor as part of your response.</p>

            </th>
        </tr>

        <tr>
            <td class="subsection_header" colspan="3"><b>Survivor Data Model:</b><br/><br/>
                <table class="data_model_table">
                <tr><th>key</th><th>R/O</th><th>&nbsp; type &nbsp;</th><th width="40%">description</th><th>related endpoints</th></tr>
                <tr><td class="key">email</td><td>O</td><td>str</td><td>Defaults to the creator's login.</td><td class="mono">set_email</td></tr>
                <tr><td class="key">born_in_ly</td><td>O</td><td>int</td><td>Defaults to the settlement's current LY.</td><td></td></tr>
                <tr><td class="key">settlement</td><td><b>R</b></td><td>OID</td><td>This must be set to a valid settlement OID at creation time and <u>can never be changed</u>. See <a href="#newSurvivor"><code>/new/survivor</code></a> above for more info on creating survivors.</td><td class="mono"></td><td></td></tr>
                <tr><td class="key">public</td><td>O</td><td>bool</td><td>Defaults to Boolean false. Submitting anything that evaluates to Boolean true will be treated as such.</td><td class="mono">toggle_boolean</td></tr>
                <tr><td class="key">name</td><td>O</td><td>str</td><td></td><td class="mono">set_name</td></tr>
                <tr><td class="key">sex</td><td>O</td><td>str</td><td>At creation time, this can be set to 'M', 'F' or 'R' (for random). Defaults to 'R' during creation if not specified in the <b>POST</b> body.</td><td class="mono">set_sex</td></tr>
                <tr><td class="key">survival</td><td>O</td><td>int</td><td></td><td class="mono">update_survival set_survival</td></tr>
                <tr><td class="key">hunt_xp</td><td>O</td><td>int</td><td></td></tr>
                <tr><td class="key">Insanity</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Head</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Arms</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Body</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Waist</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Legs</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Courage</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Understanding</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">affinities</td><td>O</td><td>dict</td><td>Rather than setting this at creation time, consider using <code>upfate_affinities</code> route after creation to set this, unless you really know what you're doing</td><td class="mono">update_affinities set_affinity</td></tr>
                <tr><td class="key">departing</td><td>O</td><td>bool</td><td></td><td class="mono">set_status_flag</td></tr>
                <tr><td class="key">bleeding_tokens</td><td>O</td><td>int</td><td></td><td class="mono">update_bleeding_tokens set_bleeding_tokens</td></tr>
                <tr><td class="key">max_bleeding_tokens</td><td>O</td><td>int</td><td>Defaults to 5.</td><td class="mono">set_attribute</td></tr>
                <tr><td class="key">Movement</td><td>O</td><td>int</td><td>Defaults to 5.</td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Accuracy</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Strength</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Evasion</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Luck</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">Speed</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">attribute_detail</td><td>O</td><td>dict</td><td></td><td class="mono">set_attribute_detail</td></tr>
                <tr><td class="key">Weapon Proficiency</td><td>O</td><td>int</td><td></td><td class="mono">set_attribute update_attribute</td></tr>
                <tr><td class="key">weapon_proficiency_type</td><td>O</td><td>str</td><td>handle</td><td class="mono">set_weapon_proficiency_type</td></tr>
                <tr><td class="key">abilities_and_impairments</td><td>O</td><td>list</td><td>Needs a list of handles from the settlement's <code>game_assets</code> element, e.g. <code>{'abilities_and_impairments': ['ageless','mastery_sword']}</code> or similar.</td><td class="mono">add_game_asset rm_game_asset</td></tr>
                <tr><td class="key">cursed_items</td><td>O</td><td>list</td><td>List of handles</td><td class="mono">add_cursed_item rm_cursed_item</tr>
                <tr><td class="key">disorders</td><td>O</td><td>list</td><td>List of handles</td><td class="mono">add_game_asset, rm_game_asset</td></tr>
                <tr><td class="key">favorite</td><td>O</td><td>list</td><td>list of user emails, i.e. users who have favorited the survivor</td><td class="mono">add_favorite rm_favorite</td></tr>
                <tr><td class="key">fighting_arts</td><td>O</td><td>list</td><td>List of handles</td><td class="mono">add_game_asset rm_game_asset</td></tr>
                <tr><td class="key">fighting_arts_levels</td><td>O</td><td>list</td><td>dictionary where each key is a Fighting Art handle whose value is an array, e.g. <code>{'silk_surgeon': [1,2]}</code></td><td class="mono">toggle_fighting_arts_level</td></tr>
                <tr><td class="key">epithets</td><td>O</td><td>list</td><td>list of handles</td><td class="mono">add_game_asset rm_game_asset</td></tr>
                </table>

                <p><b>Important!</b> There are certain endpoints below that may
                add additional attributes to a survivor record, e.g. <code>
                controls_of_death</code>, <code>set_retired</code>, etc.</p>

                <p>Attributes such as <code>dead</code> and <code>retired</code>
                are not part of the baseline data model, i.e. they are not part
                of the survivor record when it is created. YHBW</p>

            </td>
        </tr>

        <tr>
            <td class="subsection_header" colspan="3"><b><b>GET</b> routes:</b>
            retrieve various types of survivor data.</td>
        </tr>
        <tr class="ul">
            <td> /survivor/get/&lt;survivor_id&gt; </td>
            <td class="methods"> GET </td>
            <td> Retrieve a serialized version of the survivor.</td>
        </tr>
        <tr class="ul">
            <td> /survivor/remove/&lt;survivor_id&gt; </td>
            <td class="methods"> POST </td>
            <td> 
                <p>Marks a survivor as "removed", which queues them up for trash
                collection (i.e. final deletion from the database).</p>
                <p><b>Removed survivors cannot be restored or recovered.</b></p>
            </td>
        </tr>
        <tr class="ul">
            <td> <a id="getAvatarAnchor">/avatar/get/&lt;avatar_oid&gt;</a> </td>
            <td class="methods"> GET </td>
            <td>
                <p>This route does one thing: it <b>GET</b>s survivor avatars
                based on their OID and 'serves' them like a webserver would
                serve them from a filesystem.</p>
                <p>The route won't take a <b>POST</b>, it won't take params,
                etc. If successful, it will return 200 with an <code>image/png</code>
                mimetype of your avatar.</p>
                <p>Formulate your URL thus:</p>
                <code>https://api.thewatcher.io/avatar/get/5b080f754af5ca68d266b9d5</code>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/get_lineage/&lt;survivor_id&gt; </td>
            <td class="methods"> GET </td>
            <td> <p>Retrieve a dictionary of survivor family info.</p>
            <p>This method can take a minute to return, as it does recursion,
            initializes all surviviors, living and dead, etc. It's probably
            a good idea to use this one with a loading graphic, etc.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/get_survival_actions/&lt;survivor_id&gt; </td>
            <td class="methods"> GET </td>
            <td> <p>Retrieve JSON representing the Survival Actions currently
            available to the survivor: </p>
            <pre><code>
    [
        {
            "available": false,
            "sort_order": 0,
            "handle": "dodge",
            "name": "Dodge",
            "type": "survival_action",
            "title_tip": "Impairment 'Broken hip' prevents Wallace from using this ability."
        },
        {
            "available": true,
            "handle": "embolden",
            "name": "Embolden",
            "sort_order": 2,
            "type": "survival_action",
            "title_tip": "Settlement innovation 'Sun Language' unlocks this ability."
        },
        {
            "available": false,
            "handle": "overcharge",
            "name": "Overcharge",
            "sort_order": 5,
            "type": "survival_action",
            "title_tip": "Not unlocked."
        }
    ]</code></pre>
            <p>This JSON is updated automatically whenever the
            the settlement's innovations are update or the survivor's abilities
            are updated.</p>
            </td>
        </tr>


        <!-- asset mgmt -->
        <tr>
            <td class="subsection_header" colspan="3"><p><b>Asset management:</b>
            routes for adding, removing and modifying Survivor Sheet game asset
            info, e.g. Fighting Arts, Disorders, Abilities & Impairments, etc.</p>
            <p><b>Important!</b> Most of these routes have back-end business logic
            "baked" into them, so it is <u>highly recommended</u> that you reload/re-get
            your survivor's JSON after <b>POST</b>ing commands to these routes!</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/add_game_asset/&lt;survivor_id&gt; </td>
            <td class="methods"> POST </td>
            <td> <p>Use this route to add an asset 'handle' of whatever 'type'
            to a survivor.</p>
            <p>Requires both the 'handle' and 'type' keys:</p>
            <code>{'handle': 'blind', 'type': 'abilities_and_impairments'}</code>
            <code>{'handle': 'crossarm_block', 'type': 'fighting_arts'}</code>
            <p><b>Important!</b> This method enforces many of the incoming
            asset's attributes, including <code>max</code>, <code>epithet</code>,
            and so on.</p>
            <p>PROTIP: if you want the API to assign a random, eligible asset to
            the survivor, use the bogus/magic handle "_random" instead of a
            handle from the settlement's <code>game_assets</code>.</p> 
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/rm_game_asset/&lt;survivor_id&gt; </td>
            <td class="methods"> POST</td>
            <td> <p>The exact inverse of <code>add_game_asset</code>, <b>POST</b>ing to
            this route requires both 'handle' and 'type' keys and removes a game
            asset handle from a survivor. </p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_many_game_assets/&lt;survivor_id&gt; </td>
            <td class="methods"> POST </td>
            <td>
                <p>This route allows you to add or remove multiple game assets
                from a survivor by <b>POST</b>ing a list of handles/types, as if you
                were doing many <code>add_game_asset</code> or <code>rm_game_asset</code>
                operations serially.</p>
                <p>The JSON you have to <b>POST</b> must include the action you want to
                take:</p>
                <pre><code>{
    "action": "rm",
    "game_assets": [
        {"type": "abilities_and_impairments", "handle": "blind"},
        {"type": "fighting_arts", "handle": "crossarm_block"}
    ]
}</code></pre>
                <p><b>Important!</b> As with <code>set_many_attributes()</code>,
                the hashes in the <code>game_assets</code> list are pressed in
                the order you <b>POST</b> them. YHBW.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/replace_game_assets/&lt;survivor_id&gt; </td>
            <td class="methods"> POST</td>
            <td>
                <p>This route accepts a list of handles and a type of game asset
                and then evalutes the survivor's current handles of that type,
                removing and adding as necessary in order to bring the survivor's
                list in sync with the incoming list. </p>
                <p>Your JSON should look basically like this:</p>
                <pre><code>{
    "type": "abilities_and_impairments",
    "handles": [
        "bitter_frenzy","ageless","analyze"
    ]
}</code></pre>
                <p>You're going to want to also include <code>{"serialize_on_response": true}</code>
                in your <b>POST</b> body on this one, because your survivor is DEFINITELY
                going to come back way different than he was before you did this.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/add_cursed_item/&lt;survivor_id&gt; </td>
            <td class="methods">POST</td>
            <td><p><b>POST</b> a cursed item 'handle' to this route to add that cursed
            item to the survivor:</p>
            <code>{'handle': 'thunder_maul'}</code>
            <p><b>Important!</b> This will automatically apply any A&Is and
            epithets related to the curse to the survivor.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/rm_cursed_item/&lt;survivor_id&gt; </td>
            <td class="methods"> POST </td>
            <td><p><b>POST</b> a cursed item 'handle' to this route to remove that
            cursed item from the survivor:</p>
            <code>{'handle': 'husk_of_destiny'}</code>
            <p><b>Important!</b> This will automatically apply remove any epithets
            A&Is, etc. from the survivor (but will not remove any that are still
            effective, e.g. because another cursed item also requires them.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_partner/&lt;survivor_id&gt; </td>
            <td class="methods"> POST </td>
            <td>
                <p><b>POST</b> the OID of a survivor to this end point to make
                that survivor this survivor's partner:</p>
                <code>{partner_id: "5a53a2154af5ca67743c6c79"}</code>
                <p>To remove the survivor's partner, post the magic value 'UNSET'
                as the <code>partner_id</code>:</p>
                <code>{partner_id: "UNSET"}</code>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_special_attribute/&lt;survivor_id&gt; </td>
            <td class="methods"> POST </td>
            <td>
                <p>Use this route to set a survivor special attribute to a
                Boolean value:</p>
                <code>{'handle': 'pots_purified', 'value': false}</code>
                <p>A couple of things to note here:
                <ul>
                    <li>The 'handle' will be validated and if you <b>POST</b> a bad/bogus
                    handle, you'll get a 400 (or worse).</li>
                    <li>The 'value' must be a Boolean/truthy/falsy type value.
                    Anything else will get you a 400 (probably a 500, tbh).</li>
                    <li>Once added to a survivor, this attribute is not removed,
                    so it will forever be a Boolean attrib of the survivor (i.e.
                    so feel free to reference it after setting it False, etc.).</li>
                </ul>
                </p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_weapon_proficiency_type/&lt;survivor_id&gt; </td>
            <td class="methods"> POST</td>
            <td>
                <p><b>POST</b> some JSON containing a weapon proficiency type handle
                (from the settlement's <code>game_assets</code> to set it as the
                survivor's weapon type:</p>
                <code>{handle: 'sword'}</code>
                <p>To unset/remove weapon proficiency type from a survivor, <b>POST</b>
                they key <code>unset</code> to this endpoint:</p>
                <code>{unset: true}</code>
            </td>
        </tr>

        <!-- sheet attribs -->
        <tr>
            <td class="subsection_header" colspan="3"><b>Sheet Attributes:</b>
            routes for updating Survivor Sheet attributes</td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_attribute/&lt;survivor_id&gt; </td>
            <td class="methods"> POST</td>
            <td><p>Use this route to set an arbitrary survivor attribute to an
            arbitrary value. Requires 'attribute' and 'value' keys.<p>
            <p><b>POST</b> some JSON containing the 'attrib' name and the new 'value'
            like so:</p>
            <code>{'attribute': 'Strength', 'value': 3}</code>
            <p>The JSON above would set the survivor's Strength to three. The
            'value' should always be an integer. Negative numbers are supported:</p>
            <code>{'attribute': 'Evasion', 'value': -2}</code>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_many_attributes/&lt;survivor_id&gt; </td>
            <td class="methods"> <b>POST</b> </td>
            <td>
                <p>This one works similarly to <code>/survivor/set_attribute/&lt;survivor_id&gt;</code>
                or <code>/survivor/set_attribute_detail&lt;survivor_id&gt;</code>,
                except it can update a list of attribute/value pairs and/or
                a list of attribute/detail/value pairs.</p>
                <p>Assuming you want to update the base values as well as the
                details (i.e. attribute modifiers, in game parlance), the body
                of your <b>POST</b> should look something like this:</p>
                <pre><code>{
    attributes: [
        {attribute: 'Strength', value: 2},
        {attribute: 'survival', value: 5}
    ],
    attribute_details: [
        {'attribute': 'Luck', 'detail': 'tokens', 'value': 2},
        {'attribute': 'Strength', 'detail': 'gear', 'value': -1}
    ],
}</code></pre>
                <p><b>Important!</b> Since the <code>attributes</code> array will
                be processed as a Python <code>list</code> type object, attributes
                will be updated synchronously, in the order they are posted.</p>
                <p><b>Important!</b> Failures in this method <u>are not atomic</u>,
                which means that if one hash causes a failure, the whole request
                will fail and nothing will be saved!</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_attribute_detail/&lt;survivor_id&gt; </td>
            <td class="methods"> <b>POST</b> </td>
            <td> <p>All survivors have an <code>attribute_detail</code> element in
            their <code>sheet</code> JSON:</p>
            <code><pre>
        "attribute_detail": {
            "Strength": {
                "tokens": 0,
                "gear": 0
            },
            "Evasion": {
                "tokens": 0,
                "gear": 0
            },
            "Movement": {
                "tokens": 0,
                "gear": 0
            },
            "Luck": {
                "tokens": 0,
                "gear": 0
            },
            "Speed": {
                "tokens": 0,
                "gear": 0
            },
            "Accuracy": {
                "tokens": 1,
                "gear": 0
            }
        },</code></pre>
            <p>This is used to manage attribute info that is NOT the base
            attribute value (see <code>set_attribute</code> and <code>
            update_attribute</code> for updating base values).</p>
            <p>To update <code>attribute_detail</code> info, <b>POST</b> some JSON
            that includes an 'attribute', 'detail' and 'value':</p>
            <code>{'attribute': 'Luck', 'detail': 'tokens', 'value': 2}</code>
            <p>The sample code above would set the survivor's 'Luck' attribute
            detail for 'tokens' to two.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/update_attribute/&lt;survivor_id&gt; </td>
            <td class="methods"> <b>POST</b> </td>
            <td> <p>Supports arbitrary survivor attribute updates. Requires JSON
            contianing an 'attribute' and a 'modifier'. Adds the value of
            'modifier' to the current value of 'attribute'.</p>
            <p>Sample JSON to increase strength by two:</p>
            <code>{'attribute': 'Strength', 'modifier': 2}</code>
            <p>Sample JSON to decrease Insanity by 1:</p>
            <code>{'attribute': 'Insanity', 'modifier': -1}</code>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/update_bleeding_tokens/&lt;survivor_id&gt; </td>
            <td class="methods"> <b>POST</b> </td>
            <td><p> Use this to add an integer to the survivor's bleeding token
            count:</p>
            <code>{'modifier': -2}</code>
            <p><b>Important!</b> The API will never set the survivor's <code>
            bleeding_tokens</code> value lower than zero or higher than the
            survivor's <code>max_bleeding_tokens</code>. It will return 200's to
            requests that break these rules.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_bleeding_tokens/&lt;survivor_id&gt; </td>
            <td class="methods"> <b>POST</b> </td>
            <td><p> Use this route to set the survivor's <code>bleeding_tokens</code>
            attribute to an arbitrary integer value.</p>
            <code>{'value': 4}</code>
            <p>Negative values will be ignored (and you'll get a 200 back).</p>
            <p><b>Important!</b> The API will never set the survivor's <code>
            bleeding_tokens</code> value lower than zero or higher than the
            survivor's <code>max_bleeding_tokens</code>. It will return 200's to
            requests that break these rules.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_name/&lt;survivor_id&gt; </td>
            <td class="methods"> <b>POST</b> </td>
            <td><p><b>POST</b> some JSON containing the survivor's new name like so:</p>
            <code>{'name': 'Adam'}</code>
            <p><b>Important!</b> <b>POST</b>ing a blank string as the value of 'name'
            will result in the survivor's name defaulting to 'Anonymous':</p>
            <code>{'name': ''}</code>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_retired/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td><p><b>POST</b> some JSON containing a Boolean value representing whether
            the survivor is retired or not:</p>
            <code>{'retired': true}</code>
            <p>The 'retired' value will be duck-typed to a Boolean, so posting
            anything that evaluates true (e.g. 'checked') will count as a Boolean
            true, for the intents and purposes of this route.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_sex/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p>Modify the survivor's sex by <b>POST</b>ing a simple JSON object
            containing the key 'sex' and a value of either 'M' or 'F'.</p>
            <code>{'sex': 'M'}</code>
            <p><b>Important!</b> This is not the same as the survivor's
            'effective_sex' attribute, which is mutable. Make sure you're
            modifying the correct one!</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_parent/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p>Update a survivor's <code>father</code> or <code>mother</code>
            attributes by posting a role (e.g. 'father' or 'mother') plus a valid
            survivor OID to this endpoint:</p>
            <code>{role: 'father', 'oid': 59d78f014af5ca22ab609db2}</code>
            </td>
        </tr>



        <!-- survival -->
        <tr>
            <td class="subsection_header" colspan="3"><b>Survival:</b>
            routes for managing the survivor's Survival value.</td>
        </tr>
        <tr class="ul">
            <td> /survivor/update_survival/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p><b>POST</b> a 'modifier' integer to this route to add that number
            to the survivor's Survival: </p>
            <code>{"modifier": 2}</code>
            <p>...or:</p>
            <code>{"modifier": -1}</code>
            <p><b>Important!</b> The API will only allow values greater than the
            settlement's Survival Limit if expansion (or other) content requires
            the settlement to NOT enforce Survival Limit.</p>
            <p><b>Important!</b> The API will normalize negative numbers to zero
            automatically.</p> 
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_survival/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p><b>POST</b> a 'value' integer to this route to set that integer as
            the survivor's Survival value.: </p>
            <code>{"value": 6}</code>
            <p><b>Important!</b> The API will only allow values greater than the
            settlement's Survival Limit if expansion (or other) content requires
            the settlement to NOT enforce Survival Limit.</p>
            <p><b>Important!</b> The API will normalize negative numbers to zero
            automatically.</p> 
            </td>
        </tr>


        <!-- specialty/meta -->
        <tr>
            <td class="subsection_header" colspan="3"><b>Specialty routes and
            'meta' data controllers:</b> these routes allow the management of
            data beyond the standard Survivor Sheet fields. These routes
            typically expect detailed/complex JSON, so read carefully!
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/controls_of_death/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p>This route is the all-purpose route for managing aspects of
            a survivor's death, including when it happened, how it happened and
            so on. </p>
            <p>Supported key/value info:</p>
            <table class="embedded_table">
             <tr><th>key</th><th><b>R</b>/O</th><th>value</th></tr>
             <tr>
                <td class="key">dead</td>
                <td><b>R</b></td>
                <td class="value">Boolean. Set to 'true' if the survivor is dead.</td>
             </tr><tr>
                <td class="key">died_in</td>
                <td>O</td>
                <td class="value">Integer. The Lantern Year in which the survivor died.</td>
             </tr><tr>
                <td class="key">cause_of_death</td>
                <td>O</td>
                <td class="value">String. Can be anything, but check the settlement's
                assets for some recommended values: <code>game_assets.causes_of_death</code>
                </td>
             </tr>
            </table>
            <p>Here is some example JSON for marking a survivor dead:</p>
            <pre><code>
            {
                "dead": true,
                "died_in": 4,
                "cause_of_death": "Hack City",
            }
            </code></pre>
            <p>To resurrect a survivor (i.e. undo their death), simply post some
            JSON with  <code> {"dead": false} </code>,</p>
            <p>This will unset other death-related attributes, e.g. 'cause_of_death',
            'died_in', etc.</p>
            <p><b>Important!</b> Since <code>dead</code> is the only required key
            in JSON that gets <b>POST</b>ed to this route, there is some defaulting that goes
            on if the other values are undefined. Be as explicit as possible with
            this route.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_constellation/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p>For survivors with Dragon Traits (i.e. PotStars), use this
            route to set their 'constellation':</p>
            <code>{'constellation': 'Witch'}</code>
            <p>Simply <b>POST</b> similar JSON to overwrite/change it:</p>
            <code>{'constellation': 'Absolute'}</code>
            <p>This one also works to unset/remove it:</p>
            <code>{'unset': true}</code>
            <p>Here is a list of accepted/supported values for 'constellation':
            <ul>
                <li>Absolute</li>
                <li>Gambler</li>
                <li>Goblin</li>
                <li>Reaper</li>
                <li>Rust</li>
                <li>Sculptor</li>
                <li>Storm</li>
                <li>Witch</li>
            </ul>
            </p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_affinity/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p><b>POST</b> some JSON containing the two required keys, 'color' and
            'value' to set a single survivor affinity to a new integer value.</p>
            <code>{'color': 'blue', 'value': -2}</code>
            <p>The 'value' key must always have an integer value.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/update_affinities/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p>Works with the Survivor's <code>affinities</code> dictionary,
            which contains their permanent, non-token affinities and looks like
            this by default:</p>
            <code>{'red': 0, 'blue': 0, 'green': 0}</code>
            <p><b>POST</b> some JSON containing an optional 'operation' key whose value
            is 'add' or 'rm' to add or subtract an affinities dictionary called
            'aff_dict' to/from the survivor.</p>
            <p><b>Important!</b> The 'operation' key is optional because the default
            behavior of this method/route is to add the incoming 'aff_dict'.</p>
            <p>For example, if you wanted to add a permanent blue affinity to the
            survivor, you would <b>POST</b> this:</p>
            <code>{'aff_dict': {'blue': 1}}</code>
            <p>Similarly, if you wanted to add two red affinities and subtract
            one green affinity, you would <b>POST</b> a JSON object like this one:</p>
            <code>{'aff_dict': {'red': 2, 'green': -1}, 'operation': 'add'}</code>
            <p>If you wanted to subtract a blue and a green affinity from the
            survivor, you could <b>POST</b> a JSON object like this one:</p>
            <code>{'aff_dict': {'blue': 1, 'green': 1}, 'operation': 'rm'}</code>
            <p><b>Important!</b> The 'operation' key's value must be 'add' or
            'rm'. Anything else will get you a 400 response from this route.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_savior_status/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td>
                <p><b>POST</b> some JSON to this route to make a survivor into
                a savior:</p>
                <code>{color: 'red'}</code>
                <p>This adds all required A&Is, logs a settlement event, etc.</p>
                <p>To change what type of savior you want the survivor to be,
                <b>POST</b> a different color:</p>
                <code>{color: 'blue'}</code>
                <p>To remove savior status (all A&Is, etc.), <b>POST</b> the
                <code>unset</code> key to this route thus:
                <code>{unset: true}</code>
            </td>
        </tr>

        <!-- toggles and flgs -->
        <tr>
            <td class="subsection_header" colspan="3"><b>Flags and toggles:</b>
            special routes and methods for setting/unsetting 'flag' type
            aspects of the Settlement Sheet.</td>
        </tr>
        <tr class="ul">
            <td> /survivor/toggle_damage/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td>
                <p><b>POST</b> a damage location handle to this route to toggle
                it on/off for the survivor:</p>
                <code>{location: 'arms_damage_light'}</code>
                <p>Supported location handles:
                <ul>
                    <li><code>brain_damage_light</code></li>
                    <li><code>head_damage_heavy</code></li>
                    <li><code>arms_damage_light</code></li>
                    <li><code>arms_damage_heavy</code></li>
                    <li><code>body_damage_light</code></li>
                    <li><code>body_damage_heavy</code></li>
                    <li><code>waist_damage_light</code></li>
                    <li><code>waist_damage_heavy</code></li>
                    <li><code>legs_damage_light</code></li>
                    <li><code>legs_damage_heavy</code></li>
                </ul>
                </p>
                <p>Locations that are toggled 'off' will show up as <code>
                undefined</code> in the <code>sheet</code> element: the locations
                are toggled 'on' if they exist on the <code>sheet</code>.
                </p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/toggle_boolean/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p>Use this route to toggle Boolean attributes of the survivor
            data model, such as 'public'</p>
            <code>{'attribute': 'public'}</code>
            <p><p><b>Important!</b> These attributes are not the same as <code>
            status flags</code>, which also evaluate Boolean when present on the
            survivor. See <code>set_status_flag</code> and <code>toggle_status_flag</code>
            routes below for info on working with status flags.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/toggle_fighting_arts_level/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p>The API supports toggling on/off individual levels for
            Survivor Fighting Arts that have levels (e.g. Silk Surgeon). Use
            this route to toggle an individual level on or off by <b>POST</b>ing the
            handle and the level:</p>
            <code>{'handle': 'silk_surgeon', 'level': 2}</code>
            <p>The API does not enforce sequential leveling (i.e. a Survivor can
            have level 3 withing having lower levels, e.g. 1 or 2), so don't
            expect any user-friendliness here.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/toggle_sotf_reroll/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p><b>POST</b> a blank/empty request to this route to toggle the survivor's
            once per lifetime Survival of the Fittest reroll on or off.</p>
            <p><b>Important!</b> The actual attribute of the survivor's <code>
            sheet</code> is <i>sotf_reroll</i>:</p>
            <code>{"sheet": {"sotf_reroll": true, ...}, "meta": {...}, ...}</code>
            <p>But since it is not part of the default data model for survivors,
            it will sometimes simply be undefined/unset, rather than a.) always
            present and b.) always a boolean.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/toggle_status_flag/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p>Works nearly identically to <code>set_status_flag</code>
            (see above), except toggles the flag on/off. <b>POST</b> simple JSON
            containing the target 'flag' to toggle it:</p>
            <code>{'flag': 'cannot_use_fighting_arts'}</code>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_status_flag/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p> This route and its related route <code>toggle_status_flag</code>
            are used to work with Survivor Sheet 'flags'. The following 'flag'
            attributes can be set to a boolean value:</p>
            <ul>
                <li>cannot_spend_survival</li>
                <li>cannot_use_fighting_arts</li>
                <li>skip_next_hunt</li>
                <li>departing</li>
            </ul>
            <p>To set a flag (i.e. to True/true), <b>POST</b> some JSON to this route
            that includes the 'flag' key with the value of the flag you want to
            set:</p>
            <code>{'flag': 'cannot_spend_survival'}</code>
            <p> To unset/remove a flag, <b>POST</b> the key/value, plus the key 'unset'
            with a value of True/true:</p>
            <code>{'flag': 'skip_next_hunt', 'unset': True}</code>
            </td>
        </tr>

        <!-- misc. and meta -->
        <tr>
            <td class="subsection_header" colspan="3">
                <p><b>Meta and admin controls:</b>
                manage survivor meta data, including adding/removing survivor
                notes, avatars, color schemes, etc.</p>
                <p>(Includes any attribute of the Survivor Sheet that is NOT part
                of the in-box/paper tracking assets for the survivor.)</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/add_favorite/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p>Use this route to <b>POST</b> a user's email address and add the address
            to the survivor's <code>favorite</code> list, i.e. the list of users
            who have favorited the Survivor:</p>
            <code>{'user_email': 'demo@kdm-manager.com'}</code>
            <p> This route gracefully fails on bogus requests, so feel free to
            spam it (haha--j/k).</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/rm_favorite/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td> <p>Use this route to <b>POST</b> a user's email address and remove the
            address from the survivor's <code>favorite</code> list, i.e. the
            list of users who have favorited the Survivor:</p>
            <code>{'user_email': 'test@kdm-manager.com'}</code>
            <p> This route gracefully fails on bogus requests and will return a
            a 200 if asked to remove a user that is not currently in the list.</p>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/add_note/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td>
                <p>Adds a text note to a survivor. The note is returned on the
                serialized survivor (in <code>survivor.notes</code>).</p>
                <p>The <b>POST</b> body requirements are simple:</p>
                <code>{'note': 'This is my important note about Ugg-Ugg the maker
                of the soup.'}</code>
                <p>Unlike other routes, this one returns the OID of the note:</p> 
                <code>{'note_oid': {$oid: '58703a398740d9730c7abeb2'}}</code>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/rm_note/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td>
                <p><b>POST</b> an existing note OID to this route to remove it:</p>
                <code>{'_id': '58703a398740d9730c7abeb2'}</code>
            </td>
        </tr>
        <tr class="ul">
            <td> <a id="setAvatarAnchor">/survivor/set_avatar/&lt;survivor_id&gt;</a> </td>
            <td> <b>POST</b> </td>
            <td> 
                <p><b>POST</b> a base 64 encoded string to this endpoint to set a new
                avatar for a survivor:</p>
                <code>{avatar: "JJssaK1234bsakq8123..."}</code>
                <p>If you're using JS to convert a file to a base 64 string,
                consider this sample code, which may be helpful. In the sample,
                <code>evt</code> is the browser event where the users adds the file:</p>
                <pre><code>var reader = new FileReader();
reader.readAsBinaryString(evt.target.files[0]);
reader.onload = function () {
    b64_string = btoa(reader.result);
};</code></pre>
                <p>...and <code>b64_string</code> is your final output, i.e. the
                incoming file as a base 64 encoded string, that you want to <b>POST</b>
                back to the API.</p>
                <p><b>Important!</b> On a successful post, this route returns a
                200 as well as some JSON containing the OID of the new avatar:</p>
                <code>{avatar_oid: {$oid: "5a2ae8e34af5ca23a86c7247"}}</code>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_color_scheme/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td>
                <p>Serialized settlements have an element called <code>survivor_color_schemes</code>,
                which is a dictionary of color schemes, including handles.</p>
                <p>To change a survivor's color scheme, <b>POST</b> some JSON to this route
                that includes one of those handles:</p>
                <code>{handle: 'vibrant_lantern'}</code>
                <p>To unset a survivor's color scheme (i.e. to remove the key/value
                from the survivor's <code>sheet</code>, simply post the key, <code>
                unset</code>:</p>
                <code>{unset: true}</code>
            </td>
        </tr>
        <tr class="ul">
            <td> /survivor/set_email/&lt;survivor_id&gt; </td>
            <td> <b>POST</b> </td>
            <td>
                <p>POST a registered user's email to this route to set the
                survivor's email address (which is equivalent to setting the
                survivor's "owner", but does not change the survivor's <code>
                created_by</code> attribute.</p>
                <p>Your JSON should look like this:</p>
                <code>{email: 'demo@kdm-manager.com'}</code>
                <p>In order to facilitate form validation, this route will will
                return a <code>422</code> is the <code>email</code> you POST is
                not associated with a registered user of the API.</p>
                <p><b>Important!</b> If you get a 422 back, your survivor was
                <u>not</u> updated.</p>
                <p>If the update was successful, you get a vanilla <code>200
                </code> back.</p>
            </td>
        </tr>
    </table>


 </body>
</html>
